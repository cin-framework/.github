/**
 * Moroccan Cultural CAPTCHA System
 * @package CIN Framework
 * @author Mawi Man
 * @license Proprietary - All rights reserved to Ayoub Alarjani
 */
const cinQuestions={ar:[{question:"أي جيل من الويب يستهدفه CIN Framework؟",options:["Web 1","Web 2","Web 3","Web 4"],correct:3},{question:"في أي دولة تم إنشاء CIN Framework؟",options:["فرنسا","امريكا","المغرب","إسبانيا"],correct:2},{question:"في أي مدينة تم إنشاء CIN Framework؟",options:["الرباط","مراكش","فاس","طنجة"],correct:2},{question:"ما هو اسم مطور CIN Framework؟",options:["إيلون ماسك","مارك زوكربيرغ","تشانغ يي مينغ","ماوي مان"],correct:3},{question:"ما هي اللغة الأساسية التي يعتمد عليها CIN Framework؟",options:["Python","Java","PHP","Ruby"],correct:2},{question:"ما هو اللون الأساسي في تصميم موقع CIN Framework؟",options:["أخضر","أحمر","أزرق","أصفر"],correct:2},{question:"ما هو الشعار الرسمي لـ CIN Framework؟",options:["Fast and Secure","Web 3 Revolution","CIN FRAMEWORK – WEB 4 – POWERED BY LOCAL SELF-SUFFICIENCY AND AGGRESSIVE SECURITY","Powered by AI"],correct:2},{question:"ما هو البريد الإلكتروني للدعم الفني في CIN Framework؟",options:["admin@cin-framework.com","support@cin-framework.com","dev@cin-framework.com","help@cin-framework.com"],correct:1},{question:"ما هو إسم لوحة أوامر الخاص بـ CIN FRAMEWORK؟",options:["Terminal","Power Shell","CIN CIL","VS CODE"],correct:2}],en:[{question:"Which generation of the web does CIN Framework target?",options:["Web 1","Web 2","Web 3","Web 4"],correct:3},{question:"In which country was CIN Framework created?",options:["France","America","Morocco","Spain"],correct:2},{question:"In which city was CIN Framework created?",options:["Rabat","Marrakech","Fez","Tangier"],correct:2},{question:"What is the name of CIN Framework's developer?",options:["Elon Musk","Mark Zuckerberg","Zhang Yiming","Mawi Man"],correct:3},{question:"What is the main programming language that CIN Framework relies on?",options:["Python","Java","PHP","Ruby"],correct:2},{question:"What is the primary color in CIN Framework website design?",options:["green","red","blue","yellow"],correct:2},{question:"What is the official slogan of CIN Framework?",options:["Fast and Secure","Web 3 Revolution","CIN FRAMEWORK – WEB 4 – POWERED BY LOCAL SELF-SUFFICIENCY AND AGGRESSIVE SECURITY","Powered by AI"],correct:2},{question:"What is the technical support email for CIN Framework?",options:["admin@cin-framework.com","support@cin-framework.com","dev@cin-framework.com","mawi@cin-framework.com"],correct:1},{question:"What is the name of the command panel for CIN FRAMEWORK?",options:["Terminal","Power Shell","CIN CLI","VS CODE"],correct:2}]};let captchaState={currentQuestion:null,isVerified:!1,attempts:0,maxAttempts:3,currentLanguage:"ar"};const captchaTexts={ar:{title:"🇲🇦 التحقق المغربي الأصيل",subtitle:"أجب على السؤال التالي لإثبات أنك مغربي أصيل",submitButton:"تأكيد الإجابة",refreshButton:"سؤال جديد",attemptsText:"المحاولات المتبقية:",selectAnswer:"يرجى اختيار إجابة",wrongAnswer:"❌ إجابة خاطئة. المحاولات المتبقية:",correctAnswer:"🎉 ممتاز! تم التحقق بنجاح. أهلاً وسهلاً بك أخي المغربي!",maxAttempts:"❌ تم استنفاد جميع المحاولات. يرجى المحاولة لاحقاً.",emailError:"يرجى إدخال بريد إلكتروني صحيح."},en:{title:"🇲🇦 Authentic Moroccan Verification",subtitle:"Answer the following question to prove you are an authentic Moroccan",submitButton:"Confirm Answer",refreshButton:"New Question",attemptsText:"Remaining attempts:",selectAnswer:"Please select an answer",wrongAnswer:"❌ Wrong answer. Remaining attempts:",correctAnswer:"🎉 Excellent! Verification successful. Welcome, my Moroccan brother!",maxAttempts:"❌ All attempts exhausted. Please try again later.",emailError:"Please enter a valid email address."}};function initMoroccanCaptcha(){createCaptchaModal()}function createCaptchaModal(){const t=document.createElement("div");t.id="moroccanCaptchaModal",t.className="moroccan-captcha-modal";const e=captchaTexts[captchaState.currentLanguage];t.innerHTML=`\n        <div class="moroccan-captcha-container" dir="${"ar"===captchaState.currentLanguage?"rtl":"ltr"}">\n            <div class="moroccan-captcha-header">\n                <div class="moroccan-captcha-language-switcher">\n                    <button type="button" class="language-btn ${"ar"===captchaState.currentLanguage?"active":""}" onclick="switchCaptchaLanguage('ar')">العربية</button>\n                    <button type="button" class="language-btn ${"en"===captchaState.currentLanguage?"active":""}" onclick="switchCaptchaLanguage('en')">English</button>\n                </div>\n                <img src="./assets/img/moroccan-captcha.svg" alt="Moroccan CAPTCHA">\n                <h3 class="moroccan-captcha-title">${e.title}</h3>\n                <p class="moroccan-captcha-subtitle">${e.subtitle}</p>\n            </div>\n            \n            <div class="moroccan-captcha-content">\n                <div id="questionText" class="moroccan-captcha-question"></div>\n                \n                <div id="optionsContainer" class="moroccan-captcha-options"></div>\n                \n                <div class="moroccan-captcha-actions">\n                    <button id="submitCaptcha" class="moroccan-captcha-btn moroccan-captcha-btn-primary moroccan-captcha-submit">${e.submitButton}</button>\n                    <button id="refreshCaptcha" class="moroccan-captcha-btn moroccan-captcha-btn-secondary moroccan-captcha-refresh">${e.refreshButton}</button>\n                </div>\n                \n                <div id="captchaMessage" class="moroccan-captcha-message"></div>\n                \n                <div class="moroccan-captcha-attempts">\n                    <span class="attempts-text">${e.attemptsText}</span> <span id="attemptsLeft">${captchaState.maxAttempts}</span>\n                </div>\n            </div>\n        </div>\n    `,document.body.appendChild(t),document.getElementById("submitCaptcha").addEventListener("click",submitCaptchaAnswer),document.getElementById("refreshCaptcha").addEventListener("click",generateNewQuestion)}function showMoroccanCaptcha(){const t=document.getElementById("moroccanCaptchaModal");t||initMoroccanCaptcha(),captchaState.isVerified=!1,captchaState.attempts=0,generateNewQuestion(),document.getElementById("moroccanCaptchaModal").style.display="flex",setTimeout((()=>t.classList.add("open")),10)}function generateRandomQuestion(){const t=cinQuestions[captchaState.currentLanguage];return t[Math.floor(Math.random()*t.length)]}function switchCaptchaLanguage(t){captchaState.currentLanguage=t,updateCaptchaInterface(),generateNewQuestion()}function updateCaptchaInterface(){const t=captchaTexts[captchaState.currentLanguage],e=document.getElementById("moroccanCaptchaModal");if(e){const a=e.querySelector(".moroccan-captcha-title"),c=e.querySelector(".moroccan-captcha-subtitle"),n=e.querySelector(".moroccan-captcha-submit"),o=e.querySelector(".moroccan-captcha-refresh"),r=e.querySelector(".attempts-text");a&&(a.textContent=t.title),c&&(c.textContent=t.subtitle),n&&(n.textContent=t.submitButton),o&&(o.textContent=t.refreshButton),r&&(r.textContent=t.attemptsText);const s=e.querySelector(".moroccan-captcha-container");s&&(s.dir="ar"===captchaState.currentLanguage?"rtl":"ltr");e.querySelectorAll(".language-btn").forEach((t=>{t.classList.remove("active"),("العربية"===t.textContent&&"ar"===captchaState.currentLanguage||"English"===t.textContent&&"en"===captchaState.currentLanguage)&&t.classList.add("active")}))}}function shuffleArray(t){const e=[...t];for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}return e}function generateNewQuestion(){const t=generateRandomQuestion(),e=shuffleArray(t.options.map(((t,e)=>({text:t,originalIndex:e})))),a=e.findIndex((e=>e.originalIndex===t.correct));captchaState.currentQuestion={question:t.question,options:e.map((t=>t.text)),correct:a},document.getElementById("questionText").textContent=captchaState.currentQuestion.question;const c=document.getElementById("optionsContainer");c.innerHTML="",captchaState.currentQuestion.options.forEach(((t,e)=>{const a=document.createElement("div");a.className="moroccan-captcha-option",a.innerHTML=`\n            <input type="radio" name="captchaOption" value="${e}" id="option${e}">\n            <label for="option${e}">${t}</label>\n        `,c.appendChild(a)})),document.getElementById("captchaMessage").style.display="none",document.getElementById("attemptsLeft").textContent=captchaState.maxAttempts-captchaState.attempts}function submitCaptchaAnswer(){const t=document.querySelector('input[name="captchaOption"]:checked');if(!t)return void showCaptchaMessage("selectAnswer","error");const e=parseInt(t.value);document.getElementById("captchaMessage");if(e===captchaState.currentQuestion.correct)captchaState.isVerified=!0,showCaptchaMessage("correctAnswer","success"),setTimeout((()=>{closeMoroccanCaptcha(),proceedWithEmailSubmission()}),2e3);else{captchaState.attempts++;const t=captchaState.maxAttempts-captchaState.attempts;t>0?(showCaptchaMessage("wrongAnswer","error",t),document.getElementById("attemptsLeft").textContent=t,setTimeout(generateNewQuestion,1500)):(showCaptchaMessage("maxAttempts","error"),setTimeout((()=>{document.getElementById("moroccanCaptchaModal").style.display="none"}),3e3))}}function showCaptchaMessage(t,e,a=null){const c=captchaTexts[captchaState.currentLanguage],n=document.getElementById("captchaMessage");let o=c[t];"wrongAnswer"===t&&null!==a&&(o+=` ${a}`),n.textContent=o,n.style.display="block",n.className=`moroccan-captcha-message ${e}`}function closeMoroccanCaptcha(){const t=document.getElementById("moroccanCaptchaModal");t&&(t.classList.remove("open"),setTimeout((()=>{t.style.display="none"}),300))}function proceedWithEmailSubmission(){const t=document.querySelector(".cin-input-group");t.querySelector('input[type="email"]').value.trim()&&captchaState.isVerified&&handleEmailSubmit({preventDefault:()=>{},target:t})}function handleEmailSubmitWithCaptcha(t){t.preventDefault();t.target.querySelector('input[type="email"]').value.trim()?captchaState.isVerified?handleEmailSubmit(t):showMoroccanCaptcha():showMessage("يرجى إدخال بريد إلكتروني صحيح.","error")}document.addEventListener("DOMContentLoaded",initMoroccanCaptcha),window.showMoroccanCaptcha=showMoroccanCaptcha,window.handleEmailSubmitWithCaptcha=handleEmailSubmitWithCaptcha;